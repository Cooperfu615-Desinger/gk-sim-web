# GK Simulator 使用說明

本模擬器用於驗證「金庫 Crash Game」的獎勵曲線、風險曲線與道具影響，並提供數據校準與模擬功能，幫助開發團隊在開發前先確認 RTP 是否維持在 96% 左右。

---

## 功能總覽
- **基礎參數設定**：可輸入下注額、模擬局數、倍率曲線、失敗率曲線。
- **進階校準**：自動調整 λ1、λ2、λ3 與其他縮放參數，將整體 RTP 校準至 96%。
- **道具模擬**：可勾選不同道具，觀察對 RTP 與期望值的影響。
- **結果輸出**：即時計算 RTP、平均派彩、標準差，並可匯出模擬結果為 CSV。

---

## 主要欄位與參數

### 基本設定
- **下注額 (Bet)**：單局下注金額，單位為遊戲幣。
- **模擬局數 (Rounds)**：本次模擬所要執行的局數。建議 ≥ 100,000 局以得到穩定結果。

### 曲線設定
- **50 步倍率（Rewards）**  
  以逗號或換行分隔的 50 個倍率值，代表每一步的獎勵倍數。  
  例：1.05,1.10,1.15,...  
- **基準失敗率 %（Base Fail Rates）**  
  以逗號或換行分隔的 49 個失敗率，代表每一步「進入下一步」時的死亡機率。  
- **Step50 成功率**：最後一步的成功率（0~1）。

### 校準參數
- **λ1（步 1–30）**：前 30 步風險縮放因子。  
- **λ2（步 31–40）**：中段步數風險縮放因子。  
- **λ3（步 41–50）**：尾段步數風險縮放因子。  
- **倍率縮放 (Reward Scale)**：整體倍率曲線的縮放因子。  
- **基準風險縮放 (Base Fail Scale)**：調整所有失敗率的全域因子。  
- **尾段 + 絕對風險 (40–49)**：在第 40~49 步額外加的固定失敗率。  
- **最小失敗率 (≥45)**：第 45 步後失敗率的強制下限，避免尾段過於安全。

### 上限保護
- **金額上限（$）**：單局總派彩金額上限。  
- **倍率上限（x）**：單局倍率上限。  
- **下注額上限係數 α**：依下注額動態限制上限（有效上限 = min{金額上限/Bet, 倍率上限, α×金額上限/Bet}）。

---

## 模擬結果欄位
- **RTP (%)**：模擬得到的總回報率，顯示為百分比（兩位小數）。  
- **Mean Payout ($)**：平均每局派彩。  
- **Std Payout ($)**：派彩的標準差，數值越高代表波動越大。  

---

## 道具系統
每局可單獨或同時購買。購買時會扣除成本，效果如下：

- **防爆盾(把風) ×2.0**  
  - 抵擋下一次「被發現」（失敗）事件。  
  - 成本 = 下注額 × 2.0  （購買即收費）

- **聽診器(無人機) ×1.5**  
  - 在關鍵步（預設 41/43/45）提供一次「絕對安全」（若非地標）。  
  - 成本 = 下注額 × 1.5  （使用時收費）

- **精密工具(噴頭) → 兌現乘 1.5x**  
  - 啟動後，本局「最終兌現金額」乘以 1.5。  
  - 成本 = 下注額 × 1.0  （購買即收費）

- **破解器(模版) ×0.3**  
  - 立即安全前進 5 個階段，不會觸發失敗檢查與加成。  
  - 成本 = 下注額 × 0.3  （使用時收費）

---

## 使用流程
1. 輸入 **下注額** 與 **模擬局數**。  
2. （可選）修改倍率曲線、失敗率曲線與 Step50 成功率。  
3. （可選）勾選本局購買的道具。  
4. 點擊 **執行進階模擬**。  
5. 查看 **RTP (%)、Mean Payout、Std Payout**。  
6. 若需進一步貼近 96%，使用 **進階自動校準到 96%**（帶進度條，可取消）。

---

## 開發與驗證建議
- **預設值**：內建數據已調整至整體 RTP ≈ 96%。  
- **數據驗證**：建議在 1,000,000 局以上模擬，避免隨機誤差。  
- **道具平衡**：建議成本公式 = 下注額 × (EV 增量) × 安全係數 (1.05–1.15)。  
- **上限保護**：倍率與金額上限必須設定合理，避免極端爆分破壞 RTP。  

---

## 匯出
- **匯出規格 CSV**：輸出每步的倍率、風險、到達機率與 EV。  
- **匯出警戒 CSV**：列出 EV 高於目標的步驟（用於微調）。

---

## 版本備註
- 本模擬器用於數值驗證，不等於最終遊戲演出。  
- 所有參數可依市場需求調整，但務必通過 96% RTP 驗證。
